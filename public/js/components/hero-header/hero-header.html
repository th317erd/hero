<!-- Hero Header Component -->
<!-- Top bar with navigation, title, and controls -->

<!-- Document-scope styles (component positioning) -->
<style data-for="hero-header">
  hero-header {
    display: block;
    position: sticky;
    top: 0;
    z-index: 900;
  }
</style>

<!-- Shadow DOM template -->
<template data-for="hero-header">
  <style>
    :host {
      display: block;
    }

    /* Logo */
    .logo {
      height: 36px;
      width: auto;
      display: block;
    }

    .header-left {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .header-left h1 {
      margin: 0;
      line-height: 1;
    }

    .header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 8px 20px;
      background: var(--bg-secondary, #1a1a2e);
      border-bottom: 1px solid var(--border-color, #2d2d2d);
      flex-shrink: 0;
    }

    .header h1 {
      font-size: 20px;
      font-weight: 600;
      color: var(--text-primary, #e0e0e0);
    }

    .header-actions {
      display: flex;
      align-items: center;
      gap: 8px;
    }

    /* Back button - only shown in chat view */
    .back-button {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 8px 12px;
      background: transparent;
      color: var(--text-primary, #e0e0e0);
      border: none;
      border-radius: var(--radius-sm, 4px);
      font-size: 18px;
      cursor: pointer;
    }

    .back-button:hover {
      background: var(--bg-tertiary, #2a2a3e);
    }

    /* Conditional visibility based on view */
    :host([view="sessions"]) .chat-only,
    :host([view="login"]) .chat-only,
    :host([view="settings"]) .chat-only {
      display: none !important;
    }

    :host([view="chat"]) .sessions-only,
    :host([view="settings"]) .sessions-only {
      display: none !important;
    }

    :host([view="login"]) .header {
      display: none !important;
    }

    /* Hamburger Button (hidden on desktop) */
    .hamburger-button {
      display: none;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      width: 40px;
      height: 40px;
      padding: 8px;
      background: transparent;
      border: none;
      cursor: pointer;
    }

    .hamburger-icon {
      display: block;
      width: 20px;
      height: 2px;
      background: var(--text-primary, #e0e0e0);
      position: relative;
      transition: background 0.2s;
    }

    .hamburger-icon::before,
    .hamburger-icon::after {
      content: '';
      position: absolute;
      width: 20px;
      height: 2px;
      background: var(--text-primary, #e0e0e0);
      left: 0;
      transition: transform 0.2s;
    }

    .hamburger-icon::before {
      top: -6px;
    }

    .hamburger-icon::after {
      top: 6px;
    }

    /* Hamburger active state (X) */
    .hamburger-button.active .hamburger-icon {
      background: transparent;
    }

    .hamburger-button.active .hamburger-icon::before {
      transform: rotate(45deg);
      top: 0;
    }

    .hamburger-button.active .hamburger-icon::after {
      transform: rotate(-45deg);
      top: 0;
    }

    /* Mobile Menu */
    .mobile-menu {
      display: none;
      flex-direction: column;
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: var(--bg-secondary, #1a1a2e);
      border-bottom: 1px solid var(--border-color, #2d2d2d);
      box-shadow: var(--shadow, 0 4px 6px rgba(0,0,0,0.3));
      z-index: 100;
      max-height: 0;
      overflow: hidden;
      transition: max-height 0.3s ease;
    }

    .mobile-menu.open {
      max-height: 300px;
    }

    /* Responsive */
    @media (max-width: 640px) {
      .header {
        padding: 8px 12px;
        position: relative;
      }

      .header-left {
        flex: 1;
        justify-content: center;
        gap: 8px;
      }

      .header-left .logo {
        height: 24px;
      }

      .header h1 {
        font-size: 14px;
      }

      .header-actions.desktop-actions {
        display: none;
      }

      .hamburger-button {
        display: flex;
        position: absolute;
        right: 8px;
        top: 50%;
        transform: translateY(-50%);
      }

      .mobile-menu {
        display: flex;
      }

      .header-left .back-button {
        position: absolute;
        left: 8px;
      }
    }
  </style>

  <header class="header">
    <div class="header-left">
      <!-- Chat view: back button + session title -->
      <button class="back-button chat-only" data-event-onclick="goBack" title="Back to sessions">&larr;</button>
      <h1 class="header-title chat-only">@@title@@</h1>

      <!-- Sessions view: logo + "Hero" -->
      <img src="/hero/assets/images/hero-cape.svg?v=1" alt="Hero" class="logo sessions-only">
      <h1 class="header-title sessions-only">Hero</h1>
    </div>

    <div class="header-actions desktop-actions">
      <hero-main-controls layout="horizontal" context="@@context@@"></hero-main-controls>
    </div>

    <button class="hamburger-button" data-event-onclick="toggleMobileMenu" title="Menu">
      <span class="hamburger-icon"></span>
    </button>

    <div class="mobile-menu">
      <hero-main-controls layout="vertical" context="@@context@@"></hero-main-controls>
    </div>
  </header>
</template>

<script type="module" src="./hero-header.js"></script>
